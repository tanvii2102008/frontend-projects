<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Productivity Dashboard</title>
    <style>
        :root{
            --bg:#0f1724;
            --card:#0b1220;
            --muted:#9aa4b2;
            --accent:#7c5cff;
            --accent-2:#22c1c3;
            --glass: rgba(255,255,255,0.03);
            --glass-2: rgba(255,255,255,0.02);
            --radius:14px;
        }
        *{box-sizing:border-box}
        html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;color:#e6eef6;background:linear-gradient(180deg,#071024 0%, #071629 60%), var(--bg);-webkit-font-smoothing:antialiased}
        .app{max-width:1100px;margin:28px auto;padding:28px;display:grid;grid-template-columns: 320px 1fr;gap:20px}
        header{grid-column:1/-1;display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
        h1{font-size:20px;margin:0}
        .toggle-row{display:flex;gap:8px;align-items:center}
        .pill{background:var(--glass);padding:8px 12px;border-radius:999px;color:var(--muted);font-size:13px;cursor:pointer;border:1px solid rgba(255,255,255,0.03)}
        .pill.active{background:linear-gradient(90deg,var(--accent),#5de0d8);color:#04202a;font-weight:600;box-shadow:0 6px 18px rgba(124,92,255,0.15)}
        .column{display:flex;flex-direction:column;gap:18px}
        .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:18px;border-radius:var(--radius);border:1px solid rgba(255,255,255,0.03);box-shadow:0 6px 24px rgba(2,6,23,0.6)}
        /* Widgets */
        .widget-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
        .subtle{color:var(--muted);font-size:13px}
        /* To-do */
        .todo-add{display:flex;gap:8px}
        .todo-add input{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit}
        .todo-add button{padding:10px 12px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent),#5de0d8);color:#04202a;font-weight:600;cursor:pointer}
        .todo-list{margin-top:12px;display:flex;flex-direction:column;gap:8px;max-height:320px;overflow:auto;padding-right:6px}
        .todo-item{display:flex;align-items:center;gap:12px;padding:10px;border-radius:10px;background:var(--glass-2);border:1px solid rgba(255,255,255,0.01)}
        .todo-item .text{flex:1}
        .todo-item.done .text{text-decoration:line-through;color:var(--muted)}
        .btn-icon{background:transparent;border:0;color:var(--muted);cursor:pointer;padding:6px;border-radius:8px}
        /* circular progress */
        .circle{width:86px;height:86px;border-radius:50%;display:inline-grid;place-items:center;background:conic-gradient(var(--accent) var(--p,0%), rgba(255,255,255,0.04) 0);box-shadow:inset 0 -6px 18px rgba(0,0,0,0.5);position:relative}
        .circle-inner{width:74px;height:74px;border-radius:50%;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);display:flex;align-items:center;justify-content:center;flex-direction:column}
        .circle small{display:block;font-size:12px;color:var(--muted)}
        .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:18px}
        /* Habit */
        .habit-row{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px;border-radius:10px;background:var(--glass-2)}
        .habit-controls{display:flex;gap:8px;align-items:center}
        .streak{color:#ffd166;font-weight:700}
        /* Pomodoro */
        .pom-controls{display:flex;gap:8px;align-items:center;margin-top:12px}
        .sec-large{font-size:28px;font-weight:700}
        .timer-circle{width:150px;height:150px;border-radius:50%;display:grid;place-items:center;background:conic-gradient(var(--accent-2) var(--p,0%), rgba(255,255,255,0.03) 0);margin:auto}
        .controls{display:flex;gap:8px;justify-content:center;margin-top:10px}
        .btn{padding:8px 12px;border-radius:10px;border:0;background:var(--accent);color:#04202a;font-weight:600;cursor:pointer}
        .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
        /* Quotes */
        .quote{font-style:italic;color:#d9f2f0}
        footer{grid-column:1/-1;margin-top:18px;text-align:center;color:var(--muted);font-size:13px}
        /* Toggle show/hide */
        .hidden{display:none}
        /* responsive */
        @media (max-width:880px){
            .app{grid-template-columns:1fr; padding:16px}
            .column{order:initial}
        }
    </style>
</head>
<body>
    <div class="app">
        <header>
            <h1>Productivity Dashboard</h1>
            <div class="toggle-row">
                <div id="togTodo" class="pill active">To-Do</div>
                <div id="togHabit" class="pill active">Habits</div>
                <div id="togPom" class="pill active">Pomodoro</div>
                <div id="togQuote" class="pill active">Quote</div>
            </div>
        </header>

        <section class="column" style="min-width:320px">
            <!-- To-Do -->
            <div id="widget-todo" class="card">
                <div class="widget-head">
                    <div>
                        <div style="font-weight:700">To-Do List</div>
                        <div class="subtle">Tasks for today</div>
                    </div>
                    <div style="display:flex;align-items:center;gap:12px">
                        <div id="todoProgress" class="circle" style="--p:0%">
                            <div class="circle-inner">
                                <div id="todoPercent" style="font-weight:700">0%</div>
                                <small>done</small>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="todo-add">
                    <input id="todoInput" placeholder="Add new task and press Enter" />
                    <button id="addTodo">Add</button>
                </div>

                <div id="todoList" class="todo-list"></div>
            </div>

            <!-- Habit Tracker -->
            <div id="widget-habit" class="card">
                <div class="widget-head">
                    <div>
                        <div style="font-weight:700">Habit Tracker</div>
                        <div class="subtle">Mark habits done for today</div>
                    </div>
                    <div style="display:flex;gap:10px">
                        <button id="addHabitBtn" class="pill">+ New Habit</button>
                    </div>
                </div>

                <div id="habitList" style="display:flex;flex-direction:column;gap:10px"></div>
            </div>

        </section>

        <section class="column">
            <!-- Pomodoro -->
            <div id="widget-pom" class="card">
                <div class="widget-head">
                    <div>
                        <div style="font-weight:700">Pomodoro Timer</div>
                        <div class="subtle">Focus cycles with breaks</div>
                    </div>
                    <div style="display:flex;gap:8px;align-items:center">
                        <div class="subtle">Mode:</div>
                        <select id="pomMode" style="background:transparent;border-radius:8px;padding:6px;border:1px solid rgba(255,255,255,0.03);color:inherit">
                            <option value="work">Work</option>
                            <option value="short">Short Break</option>
                            <option value="long">Long Break</option>
                        </select>
                    </div>
                </div>

                <div style="display:flex;align-items:center;gap:18px;flex-wrap:wrap;justify-content:space-between">
                    <div style="flex:1">
                        <div style="text-align:center;margin-bottom:8px">
                            <div id="timerLabel" class="sec-large">25:00</div>
                            <div class="subtle" id="timerState">Ready</div>
                        </div>

                        <div style="display:flex;justify-content:center">
                            <div id="pomCircle" class="timer-circle" style="--p:0%">
                                <div style="text-align:center">
                                    <div id="pomTime" style="font-weight:800;font-size:20px">25:00</div>
                                    <div class="subtle" style="font-size:12px">cycles: <span id="cycleCount">0</span></div>
                                </div>
                            </div>
                        </div>

                        <div class="controls">
                            <button id="startPom" class="btn">Start</button>
                            <button id="pausePom" class="btn ghost">Pause</button>
                            <button id="resetPom" class="btn ghost">Reset</button>
                        </div>
                    </div>

                    <div style="width:220px">
                        <div style="display:flex;flex-direction:column;gap:8px">
                            <label class="subtle">Work (min)</label>
                            <input id="workMin" type="number" min="1" value="25" style="padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit">
                            <label class="subtle">Short Break (min)</label>
                            <input id="shortMin" type="number" min="1" value="5" style="padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit">
                            <label class="subtle">Long Break (min)</label>
                            <input id="longMin" type="number" min="1" value="15" style="padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quotes -->
            <div id="widget-quote" class="card">
                <div class="widget-head">
                    <div>
                        <div style="font-weight:700">Daily Inspiration</div>
                        <div class="subtle">A static selection of quotes</div>
                    </div>
                    <div>
                        <button id="nextQuote" class="pill">Another</button>
                    </div>
                </div>

                <div style="padding:10px 6px">
                    <div id="quoteText" class="quote" style="font-size:16px"></div>
                    <div id="quoteAuthor" class="subtle" style="margin-top:8px;text-align:right"></div>
                </div>
            </div>

        </section>

        <footer>
            Built with focus. Toggle widgets to customize your workspace.
        </footer>
    </div>

    <script>
        // Storage keys
        const TODO_KEY = 'pd_todos_v1'
        const HAB_KEY = 'pd_habits_v1'
        const POM_KEY = 'pd_pom_v1'
        // Utilities
        const qs=(s,el=document)=>el.querySelector(s)
        const qsa=(s,el=document)=>[...el.querySelectorAll(s)]

        // Toggle widgets
        const toggles = [
            {btn:qs('#togTodo'), el:qs('#widget-todo')},
            {btn:qs('#togHabit'), el:qs('#widget-habit')},
            {btn:qs('#togPom'), el:qs('#widget-pom')},
            {btn:qs('#togQuote'), el:qs('#widget-quote')}
        ]
        toggles.forEach(t=>{
            t.btn.addEventListener('click',()=>{
                const hidden = t.el.classList.toggle('hidden')
                t.btn.classList.toggle('active', !hidden)
            })
        })

        // ---------- To-Do ----------
        let todos = JSON.parse(localStorage.getItem(TODO_KEY) || '[]')
        const todoList = qs('#todoList')
        const todoInput = qs('#todoInput')
        const addTodoBtn = qs('#addTodo')
        const todoPercent = qs('#todoPercent')
        const todoProgress = qs('#todoProgress')

        function saveTodos(){ localStorage.setItem(TODO_KEY, JSON.stringify(todos)) }
        function renderTodos(){
            todoList.innerHTML = ''
            todos.forEach(t=>{
                const div = document.createElement('div')
                div.className = 'todo-item' + (t.done? ' done':'')
                div.innerHTML = `
                    <input type="checkbox" ${t.done? 'checked':''} style="width:18px;height:18px" />
                    <div class="text">${escapeHtml(t.text)}</div>
                    <div style="display:flex;gap:6px;align-items:center">
                        <button class="btn-icon btn-edit" title="Edit">‚úé</button>
                        <button class="btn-icon btn-del" title="Delete">üóëÔ∏è</button>
                    </div>
                `
                const cb = div.querySelector('input')
                cb.addEventListener('change',()=>{
                    t.done = cb.checked
                    saveTodos()
                    renderTodos()
                })
                div.querySelector('.btn-del').addEventListener('click', ()=>{
                    todos = todos.filter(x=>x.id!==t.id); saveTodos(); renderTodos()
                })
                div.querySelector('.btn-edit').addEventListener('click', ()=>{
                    const newText = prompt('Edit task', t.text)
                    if(newText!==null){ t.text = newText.trim(); saveTodos(); renderTodos() }
                })
                todoList.appendChild(div)
            })
            updateTodoProgress()
        }

        function updateTodoProgress(){
            const total = todos.length || 0
            const done = todos.filter(t=>t.done).length
            const pct = total === 0 ? 0 : Math.round(done/total*100)
            todoPercent.textContent = pct + '%'
            todoProgress.style.setProperty('--p', pct + '%')
        }

        addTodoBtn.addEventListener('click', addTodo)
        todoInput.addEventListener('keydown', e=>{ if(e.key==='Enter') addTodo() })
        function addTodo(){
            const text = todoInput.value.trim()
            if(!text) return
            todos.unshift({id:Date.now()+Math.random(), text, done:false})
            todoInput.value=''
            saveTodos(); renderTodos()
        }

        // ---------- Habit Tracker ----------
        let habits = JSON.parse(localStorage.getItem(HAB_KEY) || '[]')
        const habitList = qs('#habitList')
        const addHabitBtn = qs('#addHabitBtn')

        function saveHabits(){ localStorage.setItem(HAB_KEY, JSON.stringify(habits)) }
        function todayStr(){ return new Date().toISOString().slice(0,10) }

        function renderHabits(){
            habitList.innerHTML = ''
            habits.forEach(h=>{
                const doneToday = (h.lastDone === todayStr())
                const row = document.createElement('div')
                row.className='habit-row'
                row.innerHTML = `
                    <div style="display:flex;gap:12px;align-items:center">
                        <div style="width:10px;height:10px;border-radius:50%;background:${doneToday? 'var(--accent-2)':'transparent'};border:1px solid rgba(255,255,255,0.04)"></div>
                        <div>
                            <div style="font-weight:700">${escapeHtml(h.name)}</div>
                            <div class="subtle">Streak: <span class="streak">${h.streak||0}</span></div>
                        </div>
                    </div>
                    <div class="habit-controls">
                        <button class="btn-icon mark">${doneToday? '‚úì':'Mark'}</button>
                        <button class="btn-icon edit">‚úé</button>
                        <button class="btn-icon del">üóëÔ∏è</button>
                    </div>
                `
                row.querySelector('.mark').addEventListener('click', ()=>{
                    if(!doneToday){
                        h.lastDone = todayStr()
                        h.streak = (h.streak||0) + 1
                    } else {
                        // unmark (toggle)
                        h.lastDone = null
                        h.streak = Math.max(0,(h.streak||1)-1)
                    }
                    saveHabits(); renderHabits()
                })
                row.querySelector('.del').addEventListener('click', ()=>{
                    if(confirm('Delete habit?')){ habits = habits.filter(x=>x.id!==h.id); saveHabits(); renderHabits() }
                })
                row.querySelector('.edit').addEventListener('click', ()=>{
                    const t = prompt('Edit habit name', h.name)
                    if(t!==null){ h.name = t.trim(); saveHabits(); renderHabits() }
                })
                habitList.appendChild(row)
            })
            if(habits.length===0){
                habitList.innerHTML = `<div class="subtle">No habits yet. Add one to start building streaks.</div>`
            }
        }

        addHabitBtn.addEventListener('click', ()=>{
            const name = prompt('Habit name (e.g. "Read 20 min")')
            if(name && name.trim()){
                habits.push({id:Date.now()+Math.random(), name: name.trim(), streak:0, lastDone:null})
                saveHabits(); renderHabits()
            }
        })

        // ---------- Pomodoro ----------
        const pomMode = qs('#pomMode')
        const workMin = qs('#workMin'); const shortMin = qs('#shortMin'); const longMin = qs('#longMin')
        const startBtn = qs('#startPom'); const pauseBtn = qs('#pausePom'); const resetBtn = qs('#resetPom')
        const pomTime = qs('#pomTime'); const pomCircle = qs('#pomCircle'); const timerState = qs('#timerState'); const cycleCountEl = qs('#cycleCount')

        let pom = JSON.parse(localStorage.getItem(POM_KEY) || '{}')
        if(!pom || !pom.initialized){
            pom = {mode:'work', running:false, remaining:25*60, cycles:0, interval:null, initialized:true}
        }

        function savePom(){ localStorage.setItem(POM_KEY, JSON.stringify(pom)) }
        function formatTime(s){ const m = Math.floor(s/60); const ss = s%60; return `${String(m).padStart(2,'0')}:${String(ss).padStart(2,'0')}` }

        function setMode(mode){
            pom.mode = mode
            if(mode==='work') pom.remaining = (parseInt(workMin.value,10)||25)*60
            if(mode==='short') pom.remaining = (parseInt(shortMin.value,10)||5)*60
            if(mode==='long') pom.remaining = (parseInt(longMin.value,10)||15)*60
            updatePomUI()
            savePom()
        }

        function updatePomUI(){
            pomTime.textContent = formatTime(pom.remaining)
            const total = (pom.mode==='work'? parseInt(workMin.value,10)||25 : pom.mode==='short'? parseInt(shortMin.value,10)||5 : parseInt(longMin.value,10)||15) * 60
            const pct = Math.round((1 - pom.remaining/total) * 100)
            pomCircle.style.setProperty('--p', pct + '%')
            timerState.textContent = pom.running ? 'Running' : 'Paused'
            cycleCountEl.textContent = pom.cycles || 0
        }

        function tickPom(){
            if(pom.remaining>0){
                pom.remaining -= 1
                updatePomUI(); savePom()
            } else {
                // complete
                pom.running = false
                clearInterval(pom.interval); pom.interval = null
                // If work finished, increment cycle count:
                if(pom.mode==='work') pom.cycles = (pom.cycles||0) + 1
                // switch modes automatically
                if(pom.mode==='work'){
                    // every 4 cycles -> long break
                    if(pom.cycles % 4 === 0) setMode('long')
                    else setMode('short')
                } else {
                    setMode('work')
                }
                // auto start next
                startPom()
                savePom()
            }
        }

        function startPom(){
            if(pom.running) return
            pom.running = true
            pom.interval = setInterval(tickPom, 1000)
            updatePomUI(); savePom()
        }
        function pausePom(){
            pom.running = false
            if(pom.interval){ clearInterval(pom.interval); pom.interval = null }
            updatePomUI(); savePom()
        }
        function resetPom(){
            pausePom()
            setMode(pom.mode)
        }

        startBtn.addEventListener('click', ()=>startPom())
        pauseBtn.addEventListener('click', ()=>pausePom())
        resetBtn.addEventListener('click', ()=>resetPom())
        pomMode.addEventListener('change', (e)=>setMode(e.target.value))
        workMin.addEventListener('change', ()=>{ if(pom.mode==='work') setMode('work') })
        shortMin.addEventListener('change', ()=>{ if(pom.mode==='short') setMode('short') })
        longMin.addEventListener('change', ()=>{ if(pom.mode==='long') setMode('long') })

        // Initialize pom state
        setMode(pom.mode)
        if(pom.running){ startPom() }

        // ---------- Quotes ----------
        const quotes = [
            {t:"Focus on being productive instead of busy.", a:"Tim Ferriss"},
            {t:"The secret of getting ahead is getting started.", a:"Mark Twain"},
            {t:"Small daily improvements are the key to staggering long-term results.", a:"James Clear"},
            {t:"You don‚Äôt have to be great to start, but you have to start to be great.", a:"Zig Ziglar"},
            {t:"Simplicity boils down to two steps: identify the essential and eliminate the rest.", a:"Leo Babauta"},
            {t:"Amateurs sit and wait for inspiration, the rest of us just get up and go to work.", a:"Stephen King"},
            {t:"Do the hard jobs first. The easy jobs will take care of themselves.", a:"Dale Carnegie"},
            {t:"What gets measured gets managed.", a:"Peter Drucker"},
            {t:"Discipline is choosing between what you want now and what you want most.", a:"Abraham Lincoln"},
            {t:"Success is the sum of small efforts repeated day in and day out.", a:"Robert Collier"}
        ]
        let quoteIndex = parseInt(localStorage.getItem('pd_quote_index')||'-1',10)
        function showQuote(index){
            index = (index + quotes.length) % quotes.length
            const q = quotes[index]
            qs('#quoteText').textContent = `"${q.t}"`
            qs('#quoteAuthor').textContent = `‚Äî ${q.a}`
            quoteIndex = index
            localStorage.setItem('pd_quote_index', quoteIndex)
        }
        // pick quote of the day if not set
        if(quoteIndex < 0){
            const d = new Date(); const idx = (d.getFullYear()+d.getMonth()+d.getDate()) % quotes.length
            showQuote(idx)
        } else showQuote(quoteIndex)

        qs('#nextQuote').addEventListener('click', ()=> showQuote(quoteIndex+1))

        // ---------- Helpers & Init ----------
        function escapeHtml(s){ return s.replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]))}

        // Load initial data and render
        renderTodos()
        renderHabits()
        updatePomUI()

        // Periodic save to ensure persistence on unload
        window.addEventListener('beforeunload', ()=>{ saveTodos(); saveHabits(); savePom() })
    </script>
</body>
</html>